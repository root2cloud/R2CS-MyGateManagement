<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_party_group_invite" name="Party / Group Invite">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs" t-value="'Party/Group Invite', '/my/party/group/invite'"/>
            <!-- flag from ?show_config=1 -->
            <t t-set="show_config" t-value="request.params.get('show_config')"/>

            <!-- Page-level styles -->
            <t t-set="head">
                <style>
                    body {
                        background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
                        min-height: 100vh;
                    }
                    .pg-wrapper { max-width: 700px; margin: 0 auto; }
                    .pg-card {
                        border-radius: 12px;
                        border: 1px solid rgba(255, 255, 255, 0.2);
                        background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
                        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
                        overflow: hidden;
                    }
                    .pg-card-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 1.5rem;
                        border-radius: 12px 12px 0 0;
                    }
                    .pg-content {
                        padding: 2rem;
                        background: rgba(255, 255, 255, 0.95);
                    }
                    .section-title {
                        font-weight: 600;
                        color: #2d3748;
                        font-size: 1.2rem;
                        margin-bottom: 1.5rem;
                        padding-bottom: 0.75rem;
                        border-bottom: 2px solid #e2e8f0;
                        position: relative;
                    }
                    .section-title:after {
                        content: '';
                        position: absolute;
                        bottom: -2px;
                        left: 0;
                        width: 60px;
                        height: 2px;
                        background: linear-gradient(90deg, #667eea, #764ba2);
                    }
                    .form-label {
                        font-size: 14px;
                        color: #4a5568;
                        font-weight: 600;
                        margin-bottom: 0.5rem;
                        display: flex;
                        align-items: center;
                    }
                    .form-label:before {
                        content: '‚Ä¢';
                        color: #667eea;
                        margin-right: 6px;
                        font-weight: bold;
                    }
                    .form-control {
                        border-radius: 8px;
                        border: 2px solid #e2e8f0;
                        font-size: 15px;
                        padding: 0.75rem 1rem;
                        background: #f8fafc;
                        transition: all 0.3s ease;
                    }
                    .form-control:focus {
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                        background: white;
                        transform: translateY(-1px);
                    }
                    .btn-primary {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        border: none;
                        color: white;
                        font-weight: 600;
                        border-radius: 8px;
                        padding: 0.75rem 2rem;
                        transition: all 0.3s ease;
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                    }
                    .btn-primary:hover {
                        background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                    }
                    .btn-outline-primary {
                        color: #667eea;
                        border: 2px solid #667eea;
                        border-radius: 8px;
                        background: transparent;
                        font-weight: 500;
                        transition: all 0.3s ease;
                    }
                    .btn-outline-primary:hover {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-color: transparent;
                        transform: translateY(-1px);
                    }
                    .btn-success {
                        background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
                        border: none;
                        color: white;
                        font-weight: 600;
                        border-radius: 8px;
                        padding: 0.75rem 2rem;
                        transition: all 0.3s ease;
                        box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
                    }
                    .btn-success:hover {
                        background: linear-gradient(135deg, #20BA5A 0%, #0F8C6A 100%);
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
                    }
                    .icon-button {
                        border: 2px solid #e2e8f0;
                        border-radius: 8px;
                        background: white;
                        padding: 0.75rem;
                        font-size: 1.5rem;
                        transition: all 0.3s ease;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
                    }
                    .icon-button:hover {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-color: transparent;
                        transform: translateY(-3px) scale(1.05);
                        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
                    }
                    .whatsapp-preview {
                        background: linear-gradient(135deg, #f8fafc 0%, #edf2f7 100%);
                        border: 2px solid #e2e8f0;
                        border-radius: 10px;
                        padding: 1.5rem;
                        font-size: 0.95rem;
                        position: relative;
                        overflow: hidden;
                    }
                    .whatsapp-preview:before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 4px;
                        height: 100%;
                        background: linear-gradient(to bottom, #25D366, #128C7E);
                    }
                    .invite-card {
                        border: 2px solid #e2e8f0;
                        border-radius: 12px;
                        background: white;
                        transition: all 0.3s ease;
                        position: relative;
                        overflow: hidden;
                    }
                    .invite-card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
                        border-color: #667eea;
                    }
                    .invite-card:before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 4px;
                        background: linear-gradient(90deg, #667eea, #764ba2);
                    }
                    .invitations-section {
                        background: white;
                        border-radius: 12px;
                        padding: 2rem;
                        margin-top: 2rem;
                        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
                        border: 1px solid rgba(255, 255, 255, 0.2);
                    }
                    .text-muted {
                        color: #718096 !important;
                    }
                    .badge-count {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-radius: 20px;
                        padding: 0.25rem 0.75rem;
                        font-size: 0.85rem;
                        font-weight: 600;
                        display: inline-block;
                    }
                    .step-indicator {
                        display: flex;
                        justify-content: center;
                        margin: 2rem 0;
                        position: relative;
                    }
                    .step-dot {
                        width: 12px;
                        height: 12px;
                        border-radius: 50%;
                        background: #e2e8f0;
                        margin: 0 0.5rem;
                        transition: all 0.3s ease;
                    }
                    .step-dot.active {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        transform: scale(1.3);
                        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
                    }
                    .step-line {
                        position: absolute;
                        top: 50%;
                        left: 25%;
                        right: 25%;
                        height: 2px;
                        background: linear-gradient(90deg, #667eea, #764ba2);
                        transform: translateY(-50%);
                        z-index: -1;
                    }
                    .note-preview {
                        background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
                        border: 2px solid #ffd54f;
                        border-radius: 10px;
                        padding: 1rem;
                        margin: 1rem 0;
                        font-style: italic;
                        color: #5d4037;
                    }
                </style>
            </t>

            <div class="container my-5">
                <div class="row justify-content-center">
                    <div class="col-12 col-lg-8">
                        <!-- MAIN CARD -->
                        <div class="pg-card mb-4">
                            <div class="pg-card-header text-center">
                                <h4 class="fw-bold mb-1">
                                    <t t-esc="request.env.user.partner_id.name"/>
                                </h4>
                                <p class="mb-0 opacity-90">Create an elegant party or group invitation</p>
                            </div>

                            <div class="pg-content">
                                <!-- Step Indicator -->
                                <div class="step-indicator">
                                    <span class="step-dot active"></span>
                                    <span class="step-dot"></span>
                                    <div class="step-line"></div>
                                </div>

                                <!-- STEP 1: ADD NOTE + ICONS + NEXT (always visible) -->
                                <form method="post">
                                    <input type="hidden" name="step" value="basic"/>

                                    <div class="mb-4">
                                        <div class="section-title">Create Your Invitation</div>

                                        <div class="mb-4">
                                            <label class="form-label">Add a Personal Note</label>
                                            <div class="mb-3">
                                                <button type="button"
                                                        class="btn btn-outline-primary px-4 py-2"
                                                        onclick="document.getElementById('pg_note_wrapper').style.display='block'; document.getElementById('pg_note').focus();">
                                                    <i class="fa fa-edit me-2"></i>Write Note
                                                </button>
                                            </div>

                                            <div class="mb-4">
                                                <label class="form-label">Select Theme Icons</label>
                                                <div class="d-flex flex-wrap gap-3 justify-content-center">
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('üè†');">üè†</button>
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('üç≤');">üç≤</button>
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('üéà');">üéà</button>
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('üé¨');">üé¨</button>
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('‚ù§Ô∏è');">‚ù§Ô∏è</button>
                                                    <button type="button" class="icon-button"
                                                            onclick="pg_insert_icon('üéÇ');">üéÇ</button>
                                                </div>
                                            </div>

                                            <div id="pg_note_wrapper" class="mb-3" style="display:none;">
                                                <div class="note-preview mb-2">
                                                    <small>Preview how your note will appear to guests</small>
                                                </div>
                                                <textarea id="pg_note" name="note" class="form-control"
                                                          placeholder="Write a warm invitation message for your guests..."
                                                          rows="4">
                                                    <t t-esc="invite and invite.note or ''"/>
                                                </textarea>
                                                <div class="text-muted small mt-2">
                                                    This note will be included in the WhatsApp invitation
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-center mt-4">
                                        <button type="submit"
                                                class="btn btn-primary px-5 py-2">
                                            Continue to Settings <i class="fa fa-arrow-right ms-2"></i>
                                        </button>
                                    </div>
                                </form>

                                <!-- STEP 2: CONFIG / CREATE INVITE (only after Next) -->
                                <t t-if="invite and show_config">
                                    <div class="mt-5 pt-5 border-top">
                                        <div class="step-indicator">
                                            <span class="step-dot active"></span>
                                            <span class="step-dot active"></span>
                                            <div class="step-line"></div>
                                        </div>

                                        <div class="section-title">Customize Event Details</div>

                                        <form method="post">
                                            <input type="hidden" name="step" value="config"/>

                                            <div class="row">
                                                <div class="col-md-6 mb-4">
                                                    <label class="form-label">Event Date</label>
                                                    <input type="date" name="event_date"
                                                           t-att-value="invite.event_date"
                                                           class="form-control"/>
                                                </div>
                                                <div class="col-md-6 mb-4">
                                                    <label class="form-label">Start Time</label>
                                                    <input type="time" name="start_time"
                                                           t-att-value="( '%02d:%02d' % (int(invite.start_time or 0), int((invite.start_time or 0)%1*60)) )"
                                                           class="form-control"/>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6 mb-4">
                                                    <label class="form-label">Duration (Hours)</label>
                                                    <input type="number" name="valid_hours"
                                                           t-att-value="invite.valid_hours or 8"
                                                           class="form-control"
                                                           min="1" max="24"/>
                                                </div>
                                                <div class="col-md-6 mb-4">
                                                    <label class="form-label">Location</label>
                                                    <input type="text" name="location"
                                                           t-att-value="invite.location or ''"
                                                           class="form-control"
                                                           placeholder="Venue address"/>
                                                </div>
                                            </div>

                                            <div class="mb-5">
                                                <label class="form-label">Expected Number of Guests</label>
                                                <div class="mb-3">
                                                    <div class="d-flex gap-3 mb-3">
                                                        <button type="button" class="btn btn-outline-primary flex-fill py-2"
                                                                onclick="document.getElementById('pg_max_guests').value=5;">
                                                            Small (5)
                                                        </button>
                                                        <button type="button" class="btn btn-outline-primary flex-fill py-2"
                                                                onclick="document.getElementById('pg_max_guests').value=20;">
                                                            Medium (20)
                                                        </button>
                                                        <button type="button" class="btn btn-outline-primary flex-fill py-2"
                                                                onclick="document.getElementById('pg_max_guests').value=50;">
                                                            Large (50)
                                                        </button>
                                                    </div>
                                                </div>
                                                <input id="pg_max_guests" type="number" name="max_guests"
                                                       t-att-value="invite.max_guests or 5"
                                                       class="form-control" min="1" max="50"
                                                       placeholder="Or enter custom number"/>
                                            </div>

                                            <div class="text-center">
                                                <button type="submit"
                                                        class="btn btn-primary px-5 py-2">
                                                    <i class="fa fa-check-circle me-2"></i>Create Invitation
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </t>

                                <!-- WHATSAPP WEB SHARE (when active) -->
                                <div class="mt-5 pt-5 border-top" t-if="invite and invite.state == 'active'">
                                    <div class="section-title">Share Your Invitation</div>

                                    <t t-set="base_url"
                                       t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
                                    <t t-set="portal_url"
                                       t-value="base_url + '/party/invite/' + str(invite.id) + '/' + (invite.token or '')"/>

                                    <t t-set="line1" t-value="'üéâ PARTY / GROUP INVITE'"/>
                                    <t t-set="line2" t-value="'üë§ Host: ' + (invite.host_id.name or '')"/>
                                    <t t-set="line3" t-value="'üìù Note: ' + (invite.note or 'Not set')"/>
                                    <t t-set="line4" t-value="'üìÑ Description: ' + (invite.description or 'Not set')"/>
                                    <t t-set="line5"
                                       t-value="'üìÖ Date: ' + (str(invite.event_date) if invite.event_date else 'Not set')"/>
                                    <t t-set="line6" t-value="'üìç Location: ' + (invite.location or 'Not set')"/>
                                    <t t-set="line7" t-value="'üë• Guests: ' + str(invite.max_guests or 0)"/>
                                    <t t-set="line8" t-value="'üîó Link: ' + portal_url"/>

                                    <t t-set="message"
                                       t-value="line1 + '%0A%0A' + line2 + '%0A' + line3 + '%0A' + line4 + '%0A' + line5 + '%0A' + line6 + '%0A' + line7 + '%0A%0A' + line8"/>

                                    <t t-set="whatsapp_url"
                                       t-value="'https://web.whatsapp.com/send?text=' + message"/>

                                    <div class="text-center">
                                        <div class="mb-4">
                                            <div class="whatsapp-preview">
                                                <div class="fw-bold text-primary mb-2">WhatsApp Preview</div>
                                                <div class="small text-muted">
                                                    Your invitation will be sent in this format
                                                </div>
                                            </div>
                                        </div>

                                        <a t-att-href="whatsapp_url"
                                           class="btn btn-success px-5 py-2 mb-2"
                                           target="_blank" rel="noopener noreferrer">
                                            <i class="fa fa-whatsapp me-2"></i>Share via WhatsApp Web
                                        </a>
                                        <div class="small text-muted">
                                            Opens WhatsApp Web with pre-filled elegant invitation
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- YOUR INVITES LIST -->
                        <div class="invitations-section">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="section-title mb-0" style="border-bottom: none;">Your Active Invitations</h5>
                                <span class="badge-count">
                                    <t t-esc="len(invites) or 0"/> Invitations
                                </span>
                            </div>

                            <div class="row">
                                <t t-foreach="invites" t-as="invite_item">
                                    <div class="col-md-6 mb-4">
                                        <div class="invite-card h-100">
                                            <div class="card-body p-4">
                                                <!-- CLICKABLE TITLE -->
                                                <h6 class="card-title mb-3">
                                                    <a t-att-href="'/my/party/group/invite/' + str(invite_item.id)"
                                                       class="text-decoration-none fw-bold text-primary">
                                                        <i class="fa fa-envelope-open-text me-2"></i>
                                                        Invitation #
                                                        <t t-esc="invite_item.id"/>
                                                    </a>
                                                </h6>

                                                <!-- WHATSAPP PREVIEW -->
                                                <div class="whatsapp-preview mb-4">
                                                    <div class="fw-bold text-primary mb-2">üéâ PARTY / GROUP INVITE</div>
                                                    <div class="mb-1">
                                                        <i class="fa fa-user me-1"></i>
                                                        Host: <span class="fw-medium"><t t-esc="invite_item.host_id.name or 'Not set'"/></span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <i class="fa fa-sticky-note me-1"></i>
                                                        Note: <span class="fw-medium"><t t-esc="invite_item.note or 'Not set'"/></span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <i class="fa fa-align-left me-1"></i>
                                                        Description: <span class="fw-medium"><t t-esc="invite_item.description or 'Not set'"/></span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <i class="fa fa-calendar me-1"></i>
                                                        Date: <span class="fw-medium"><t t-esc="str(invite_item.event_date) if invite_item.event_date else 'Not set'"/></span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <i class="fa fa-map-marker me-1"></i>
                                                        Location: <span class="fw-medium"><t t-esc="invite_item.location or 'Not set'"/></span>
                                                    </div>
                                                    <div>
                                                        <i class="fa fa-users me-1"></i>
                                                        Max Guests: <span class="fw-medium"><t t-esc="str(invite_item.max_guests or 0)"/></span>
                                                    </div>
                                                </div>

                                                <!-- WHATSAPP SHARE BUTTON -->
                                                <div class="mt-3">
                                                    <t t-set="base_url"
                                                       t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
                                                    <t t-set="portal_url"
                                                       t-value="base_url + '/party/invite/' + str(invite_item.id) + '/' + (invite_item.token or '')"/>
                                                    <t t-set="whatsapp_msg"
                                                       t-value="'üéâ PARTY / GROUP INVITE%0A%0Aüë§ Host: ' + (invite_item.host_id.name or '') + '%0Aüìù Note: ' + (invite_item.note or 'Not set') + '%0AüìÑ Description: ' + (invite_item.description or 'Not set') + '%0AüìÖ Date: ' + (str(invite_item.event_date) if invite_item.event_date else 'Not set') + '%0Aüìç Location: ' + (invite_item.location or 'Not set') + '%0Aüë• Guests: ' + str(invite_item.max_guests or 0) + '%0A%0Aüîó ' + portal_url"/>

                                                    <a t-att-href="'https://web.whatsapp.com/send?text=' + whatsapp_msg"
                                                       class="btn btn-success w-100 py-2"
                                                       target="_blank">
                                                        <i class="fa fa-whatsapp me-2"></i>Share on WhatsApp
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>

                            <t t-if="not invites">
                                <div class="text-center py-5">
                                    <div class="text-muted mb-3">
                                        <i class="fa fa-envelope fa-3x mb-3 opacity-50"></i>
                                        <h5>No active invitations</h5>
                                        <p class="mb-0">Create your first elegant invitation above</p>
                                    </div>
                                </div>
                            </t>
                        </div>
                    </div>
                </div>
            </div>

            <!-- JS helper -->
            <script type="text/javascript">
                function pg_insert_icon(icon) {
                    var textarea = document.getElementById('pg_note');
                    if (!textarea) { return; }
                    document.getElementById('pg_note_wrapper').style.display = 'block';
                    textarea.focus();
                    var start = textarea.selectionStart || 0;
                    var end = textarea.selectionEnd || 0;
                    var value = textarea.value || '';
                    textarea.value = value.substring(0, start) + icon + ' ' + value.substring(end);
                    var newPos = start + icon.length + 1;
                    textarea.setSelectionRange(newPos, newPos);

                    // Show preview
                    var preview = document.querySelector('.note-preview');
                    if (preview) {
                        preview.innerHTML = '<small>Preview: "' + textarea.value.substring(0, 50) + (textarea.value.length > 50 ? '...' : '') + '"</small>';
                    }
                }
            </script>
        </t>
    </template>
</odoo>

<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    <template id="portal_party_group_invite" name="Party / Group Invite">-->
<!--        <t t-call="portal.portal_layout">-->
<!--            <t t-set="breadcrumbs" t-value="'Party/Group Invite', '/my/party/group/invite'"/>-->
<!--            &lt;!&ndash; flag from ?show_config=1 &ndash;&gt;-->
<!--            <t t-set="show_config" t-value="request.params.get('show_config')"/>-->

<!--            <div class="container my-4">-->
<!--                <div class="row justify-content-center">-->
<!--                    <div class="col-12 col-md-6">-->

<!--                        &lt;!&ndash; MAIN CARD &ndash;&gt;-->
<!--                        <div class="pg-card position-relative overflow-hidden"-->
<!--                             style="border-radius:24px; background:#f5f1eb;">-->

<!--                            <div class="pg-content p-4" style="position:relative; z-index:2;">-->
<!--                                <div class="text-center mb-4">-->
<!--                                    <h4 class="fw-bold" style="color:#5a3b12;">-->
<!--                                        <t t-esc="request.env.user.partner_id.name"/>-->
<!--                                        has invited you.-->
<!--                                    </h4>-->
<!--                                </div>-->

<!--                                &lt;!&ndash; STEP 1: ADD NOTE + ICONS + NEXT (always visible) &ndash;&gt;-->
<!--                                <form method="post">-->
<!--                                    <input type="hidden" name="step" value="basic"/>-->

<!--                                    <div class="text-center mb-4">-->
<!--                                        <button type="button"-->
<!--                                                class="btn btn-light px-4 py-2 rounded-pill shadow-sm"-->
<!--                                                style="background:#ffffff;"-->
<!--                                                onclick="document.getElementById('pg_note_wrapper').style.display='block'; document.getElementById('pg_note').focus();">-->
<!--                                            Add a note-->
<!--                                        </button>-->
<!--                                    </div>-->

<!--                                    <div class="mb-4 text-center">-->
<!--                                        <div class="d-inline-flex gap-2">-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('üè†');">üè†-->
<!--                                            </button>-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('üç≤');">üç≤-->
<!--                                            </button>-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('üéà');">üéà-->
<!--                                            </button>-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('üé¨');">üé¨-->
<!--                                            </button>-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('‚ù§Ô∏è');">‚ù§Ô∏è-->
<!--                                            </button>-->
<!--                                            <button type="button" class="badge bg-light border rounded-3 p-3"-->
<!--                                                    onclick="pg_insert_icon('üéÇ');">üéÇ-->
<!--                                            </button>-->
<!--                                        </div>-->
<!--                                    </div>-->

<!--                                    <div id="pg_note_wrapper" class="mb-3" style="display:none;">-->
<!--                                        <textarea id="pg_note" name="note" class="form-control"-->
<!--                                                  placeholder="Add a note for security or guests...">-->
<!--                                            <t t-esc="invite and invite.note or ''"/>-->
<!--                                        </textarea>-->
<!--                                    </div>-->

<!--                                    <div class="text-center mt-3">-->
<!--                                        <button type="submit"-->
<!--                                                class="btn px-4 py-1 fw-bold"-->
<!--                                                style="background:#ffd600;color:#111827;border-radius:20px;font-size:0.9rem;">-->
<!--                                            Next-->
<!--                                        </button>-->
<!--                                    </div>-->
<!--                                </form>-->

<!--                                &lt;!&ndash; STEP 2: CONFIG / CREATE INVITE (only after Next) &ndash;&gt;-->
<!--                                <t t-if="invite and show_config">-->
<!--                                    <div class="mt-4 pt-3 border-top">-->
<!--                                        <div class="d-flex justify-content-between align-items-center mb-3">-->
<!--                                            <span class="text-primary small">Customise</span>-->
<!--                                        </div>-->

<!--                                        <form method="post">-->
<!--                                            <input type="hidden" name="step" value="config"/>-->

<!--                                            <div class="mb-3">-->
<!--                                                <label class="form-label small text-muted">Select Date</label>-->
<!--                                                <input type="date" name="event_date"-->
<!--                                                       t-att-value="invite.event_date"-->
<!--                                                       class="form-control rounded-3"/>-->
<!--                                            </div>-->

<!--                                            <div class="row mb-3">-->
<!--                                                <div class="col-6">-->
<!--                                                    <label class="form-label small text-muted">Starting from</label>-->
<!--                                                    <input type="time" name="start_time"-->
<!--                                                           t-att-value="( '%02d:%02d' % (int(invite.start_time or 0), int((invite.start_time or 0)%1*60)) )"-->
<!--                                                           class="form-control rounded-3"/>-->
<!--                                                </div>-->
<!--                                                <div class="col-6">-->
<!--                                                    <label class="form-label small text-muted">Valid for</label>-->
<!--                                                    <input type="number" name="valid_hours"-->
<!--                                                           t-att-value="invite.valid_hours or 8"-->
<!--                                                           class="form-control rounded-3"/>-->
<!--                                                </div>-->
<!--                                            </div>-->

<!--                                            <div class="mb-3">-->
<!--                                                <label class="form-label small text-muted">Location/Venue</label>-->
<!--                                                <input type="text" name="location"-->
<!--                                                       t-att-value="invite.location or ''"-->
<!--                                                       class="form-control rounded-3"-->
<!--                                                       placeholder="Block 10 10096, MVV City"/>-->
<!--                                            </div>-->

<!--                                            <div class="mb-4">-->
<!--                                                <label class="form-label small text-muted">-->
<!--                                                    How many guests are you expecting? (max 50)-->
<!--                                                </label>-->
<!--                                                <div class="d-flex gap-2 mb-2">-->
<!--                                                    <button type="button" class="btn btn-outline-primary flex-fill"-->
<!--                                                            onclick="document.getElementById('pg_max_guests').value=5;">-->
<!--                                                        5-->
<!--                                                    </button>-->
<!--                                                    <button type="button" class="btn btn-outline-primary flex-fill"-->
<!--                                                            onclick="document.getElementById('pg_max_guests').value=20;">-->
<!--                                                        20-->
<!--                                                    </button>-->
<!--                                                    <button type="button" class="btn btn-outline-primary flex-fill"-->
<!--                                                            onclick="document.getElementById('pg_max_guests').value=50;">-->
<!--                                                        50-->
<!--                                                    </button>-->
<!--                                                </div>-->
<!--                                                <input id="pg_max_guests" type="number" name="max_guests"-->
<!--                                                       t-att-value="invite.max_guests or 5"-->
<!--                                                       class="form-control rounded-3" min="1" max="50"-->
<!--                                                       placeholder="Custom"/>-->
<!--                                            </div>-->

<!--                                            <div class="text-center mt-3">-->
<!--                                                <button type="submit"-->
<!--                                                        class="btn px-5 py-1 fw-bold"-->
<!--                                                        style="background:#ffd600;color:#111827;border-radius:20px;font-size:0.9rem;">-->
<!--                                                    Create Invite-->
<!--                                                </button>-->
<!--                                            </div>-->

<!--                                        </form>-->
<!--                                    </div>-->
<!--                                </t>-->

<!--                                &lt;!&ndash; WHATSAPP WEB SHARE (when active) &ndash;&gt;-->
<!--                                <div class="text-center mb-4 mt-4" t-if="invite and invite.state == 'active'">-->
<!--                                    <t t-set="base_url"-->
<!--                                       t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>-->
<!--                                    <t t-set="portal_url"-->
<!--                                       t-value="base_url + '/party/invite/' + str(invite.id) + '/' + (invite.token or '')"/>-->

<!--                                    <t t-set="line1" t-value="'üéâ PARTY / GROUP INVITE'"/>-->
<!--                                    <t t-set="line2" t-value="'üë§ Host: ' + (invite.host_id.name or '')"/>-->
<!--                                    <t t-set="line3" t-value="'üìù Note: ' + (invite.note or 'Not set')"/>-->
<!--                                    <t t-set="line4" t-value="'üìÑ Description: ' + (invite.description or 'Not set')"/>-->
<!--                                    <t t-set="line5"-->
<!--                                       t-value="'üìÖ Date: ' + (str(invite.event_date) if invite.event_date else 'Not set')"/>-->
<!--                                    <t t-set="line6" t-value="'üìç Location: ' + (invite.location or 'Not set')"/>-->
<!--                                    <t t-set="line7" t-value="'üë• Guests: ' + str(invite.max_guests or 0)"/>-->
<!--                                    <t t-set="line8" t-value="'üîó Link: ' + portal_url"/>-->

<!--                                    <t t-set="message"-->
<!--                                       t-value="line1 + '%0A%0A' + line2 + '%0A' + line3 + '%0A' + line4 + '%0A' + line5 + '%0A' + line6 + '%0A' + line7 + '%0A%0A' + line8"/>-->


<!--                                    <t t-set="whatsapp_url"-->
<!--                                       t-value="'https://web.whatsapp.com/send?text=' + message"/>-->

<!--                                    <div class="text-center mt-3">-->
<!--                                        <a t-att-href="whatsapp_url"-->
<!--                                           class="btn btn-success px-4 py-1 fw-bold"-->
<!--                                           style="background:#25D366;color:#ffffff;border-radius:20px;font-size:0.9rem;border:none;"-->
<!--                                           target="_blank" rel="noopener noreferrer">-->
<!--                                            üì± Share via WhatsApp Web-->
<!--                                        </a>-->
<!--                                    </div>-->
<!--                                    <div class="mt-3 small text-muted">-->
<!--                                        Opens WhatsApp Web instantly with pre-filled invite message-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->

<!--                        </div>-->


<!--                        &lt;!&ndash; YOUR INVITES LIST &ndash;&gt;-->
<!--                        &lt;!&ndash; YOUR INVITES LIST &ndash;&gt;-->
<!--                        <div class="container mt-4">-->
<!--                            <h5 class="mb-3">Your Active Invites</h5>-->
<!--                            <div class="row">-->
<!--                                <t t-foreach="invites" t-as="invite_item">-->
<!--                                    <div class="col-md-6 col-lg-4 mb-4">-->
<!--                                        <div class="card h-100 shadow-sm border-primary">-->
<!--                                            <div class="card-body p-3">-->
<!--                                                &lt;!&ndash; CLICKABLE TITLE (KEEP AS IS) &ndash;&gt;-->
<!--                                                <h6 class="card-title mb-3">-->
<!--                                                    <a t-att-href="'/my/party/group/invite/' + str(invite_item.id)"-->
<!--                                                       class="text-decoration-none fw-bold text-primary">-->
<!--                                                        Invite #-->
<!--                                                        <t t-esc="invite_item.id"/>-->
<!--                                                    </a>-->
<!--                                                </h6>-->

<!--                                                &lt;!&ndash; FULL WHATSAPP PREVIEW FORMAT (KEEP AS IS) &ndash;&gt;-->
<!--                                                <div class="whatsapp-preview small" style="line-height: 1.4;">-->
<!--                                                    <div class="fw-bold text-primary mb-1">üéâ PARTY / GROUP INVITE</div>-->
<!--                                                    <div>üë§ Host:-->
<!--                                                        <t t-esc="invite_item.host_id.name or 'Not set'"/>-->
<!--                                                    </div>-->
<!--                                                    <div>üìù Note:-->
<!--                                                        <t t-esc="invite_item.note or 'Not set'"/>-->
<!--                                                    </div>-->
<!--                                                    <div>üìÑ Description:-->
<!--                                                        <t t-esc="invite_item.description or 'Not set'"/>-->
<!--                                                    </div>-->
<!--                                                    <div>üìÖ Date:-->
<!--                                                        <t t-esc="str(invite_item.event_date) if invite_item.event_date else 'Not set'"/>-->
<!--                                                    </div>-->
<!--                                                    <div>üìç Location:-->
<!--                                                        <t t-esc="invite_item.location or 'Not set'"/>-->
<!--                                                    </div>-->
<!--                                                    <div>üë• Guests:-->
<!--                                                        <t t-esc="str(invite_item.max_guests or 0)"/>-->
<!--                                                    </div>-->
<!--                                                </div>-->

<!--                                                &lt;!&ndash; ADD THIS WHATSAPP SHARE BUTTON &ndash;&gt;-->
<!--                                                <div class="mt-2 pt-1 border-top">-->
<!--                                                    <t t-set="base_url"-->
<!--                                                       t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>-->
<!--                                                    <t t-set="portal_url"-->
<!--                                                       t-value="base_url + '/party/invite/' + str(invite_item.id) + '/' + (invite_item.token or '')"/>-->
<!--                                                    <t t-set="whatsapp_msg"-->
<!--                                                       t-value="'üéâ PARTY / GROUP INVITE%0A%0Aüë§ Host: ' + (invite_item.host_id.name or '') + '%0Aüìù Note: ' + (invite_item.note or 'Not set') + '%0AüìÑ Description: ' + (invite_item.description or 'Not set') + '%0AüìÖ Date: ' + (str(invite_item.event_date) if invite_item.event_date else 'Not set') + '%0Aüìç Location: ' + (invite_item.location or 'Not set') + '%0Aüë• Guests: ' + str(invite_item.max_guests or 0) + '%0A%0Aüîó ' + portal_url"/>-->

<!--                                                    <a t-att-href="'https://web.whatsapp.com/send?text=' + whatsapp_msg"-->
<!--                                                       class="btn btn-success w-100 py-1 fw-bold"-->
<!--                                                       style="background:#25D366;color:white;border-radius:16px;border:none;font-size:0.85rem;"-->
<!--                                                       target="_blank">-->
<!--                                                        üì± Share WhatsApp-->
<!--                                                    </a>-->
<!--                                                </div>-->

<!--                                            </div>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </t>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; JS helper &ndash;&gt;-->
<!--            <script type="text/javascript">-->
<!--                function pg_insert_icon(icon) {-->
<!--                var textarea = document.getElementById('pg_note');-->
<!--                if (!textarea) { return; }-->
<!--                document.getElementById('pg_note_wrapper').style.display = 'block';-->
<!--                textarea.focus();-->
<!--                var start = textarea.selectionStart || 0;-->
<!--                var end = textarea.selectionEnd || 0;-->
<!--                var value = textarea.value || '';-->
<!--                textarea.value = value.substring(0, start) + icon + ' ' + value.substring(end);-->
<!--                var newPos = start + icon.length + 1;-->
<!--                textarea.setSelectionRange(newPos, newPos);-->
<!--                }-->
<!--            </script>-->

<!--        </t>-->
<!--    </template>-->
<!--</odoo>-->
